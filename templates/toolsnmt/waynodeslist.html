{% extends 'toolsnmt/base.html' %}
{% block title %}Herramienta para Alturas{% endblock %}
<html>
<head>
{% block css %}
    <link media="all" rel="stylesheet" href="media/css/locations_tool.css" type="text/css"></link>
{% endblock %}

{% block js_onload %}

    state = new Maap.State();
    state.init();        
    
    $("#update_nodes").click(function (event, object) {
        var dir = 'update_nodes?street={{ street }}&';
        var dir_f = dir + $("form").serialize();
        window.location = dir_f;
        return false;
    });
        
    $(".node-link").click(function (event, object) {
        state.toogleLayer($(this).attr('id'),null,function (data) {return 0;});
        return false;
    });
  
    //muestra la calle en el mapa
    $(document).ready(function () {
        state.loadLayer('show_street?street={{ street }}', null, function (data) {return 0;});
    });
    
    //code for selector street
    $('#street').change(function () {
        var value = $('#street option:selected').val();
        window.location = 'nodes_by_street?street=' + value;
    });
        

{% endblock %}

</head>
<body>
{% block content %}
<div id="wrapper">
<div id="top">
    <div id="logo">
    <img src='/media/img/nomenclador_t.jpg'  />
    </div>

    <div id="app_name">{% block app_name %} Administracion de Alturas {% endblock %}</div>

</div>

<div id="nav_slot">
{% block nav %}
<ul id="nav">
  <li><a href="/">Inicio</a></li>
  <li><a href="/tools/synchronization">Syncro</a></li>
  <li><a href="/tools/old_streets">Nombres Antiguos</a></li>
  <li><a href="/tools/help">Ayuda</a></li>
</ul>
{% endblock %}
</div>

{% block street_selector %}
<div id="street_selector"> 
    <p> Por favor, seleccione una calle: </p>    
     
    <select id="street">
    {% for street_i in streets2 %}
        {% ifequal street_i.name street %}
            <option value="{{street_i.name }}" selected>{{ street_i.name }}</option>
        {% else %}
            <option value="{{street_i.name }}" >{{ street_i.name }}</option>
        {% endifequal %}
    {% empty %}
        <option value="" >No hay calles disponibles </option>
    {% endfor%}
    </select>
</div>
{% endblock %} 

<div id="left">
{% block left %} 

{% endblock %} 
</div>

<div id="map">
{% block map %}


{% endblock %}
</div>

<div id="footer" class="visualClear">
    <span id="credits">&copy;2009 Comercio y Justicia</span>
</div>
</div>
{% if nodes %}
<form>
<div>
<ol class="scrollable">
    {% for nod in nodes %}
    <li> 
        <a href="#" 
           class="node-link"  
           id="{{ nod.node.id }}"> 
           {{ nod.node.id }} 
        </a> 

        {% if nod.waynodesdoor %} 
            <input type="text" 
                   name="{{ nod.id }}" 
                   tabindex="{{forloop.counter|add:'1'}}" 
                   id="{{ nod.id }}"  
                   value="{{ nod.waynodesdoor.number }}" />
         {% else %}
            <input type="text" 
                   name="{{ nod.id }}" 
                   tabindex="{{forloop.counter|add:'1'}}" 
                   id="{{ nod.id }}"  
                   value="Editar Valor" />  
         {% endif%}
    </li>
    {% empty %}
    <li>Esta calle no contiene nodos</li>
    {% endfor %}
    </ol>
    

   <input type="submit" 
          id="update_nodes" 
          value="Actualizar" />

 </div>
 </form>

{% else %}
<p id="init_text"> <h4>Se debe seleccionar una calle para que se muestren los nodos asociados a esta </h4></p>
{% endif%}
{% endblock %}
</html>


